---
title: "Analysis of Heart Disease"
output: html_notebook
---

# Libraries
```{r}
library(tidyverse)
library(here)
```

# Load Data
```{r}
# Load the pre-processed heart disease dataset
heart_data <- read_csv(here("data", "heart_data.csv"))
```

# Create Outcome Variable
```{r}
# construct binary primary outcome of any_heart_disease from num > 0
heart_data <- heart_data %>%
  mutate(any_heart_disease = ifelse(num > 0, 1, 0))
```

# Logistic Regression Model
This section performs a logistic regression to model the likelihood of heart disease based on age and cholesterol levels.

```{r}
# Fit the logistic regression model
# The outcome variable is any_heart_disease
# The predictor variables are age and chol
logistic_model <- glm(any_heart_disease ~ age + chol, 
                      data = heart_data, 
                      family = binomial)

# Display the summary of the model to see the results
summary(logistic_model)
```

# Cholesterol vs. Age by Heart Disease Status
```{r}
# Create a scatter plot of cholesterol vs. age, colored by heart disease status
heart_data %>% 
    mutate(any_heart_disease = factor(any_heart_disease, levels = c(0,1), labels = c("No", "Yes"))) %>% 
    ggplot(aes(x = age, y = chol, color = any_heart_disease)) + 
    geom_point(alpha=0.7) + 
    labs(title = "Cholesterol vs. Age by Heart Disease Status",
        x = "Age",
        y = "Cholesterol (mg/dl)",
        color = "Heart Disease") + 
    theme_minimal()
```


